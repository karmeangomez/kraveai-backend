#!/bin/bash
# ğŸ“‚ ~/kraveai-backend/krave-update

# 1. Ir al directorio correcto automÃ¡ticamente
cd /home/karmean/kraveai-backend

# 2. Actualizar desde GitHub
echo "ğŸ” Actualizando KraveAI desde GitHub..."
git fetch origin
git reset --hard origin/main

# 3. Instalar dependencias si es necesario
if [ -f "package.json" ]; then
  echo "ğŸ“¦ Instalando dependencias..."
  npm install --production
fi

# 4. Reconstruir mÃ³dulos nativos
echo "âš™ï¸ Reconstruyendo mÃ³dulos nativos..."
npm rebuild

# 5. Reiniciar servicio
echo "ğŸš€ Reiniciando servicios..."
sudo systemctl restart crear-cuentas.service

# 6. Verificar estado
echo "âœ… ActualizaciÃ³n completada. Estado:"
sudo systemctl status crear-cuentas.service --no-pager

# 7. Mostrar Ãºltimas cuentas
echo "ğŸ“‚ Ãšltimas cuentas:"
tail -n 5 cuentas_creadas.json
